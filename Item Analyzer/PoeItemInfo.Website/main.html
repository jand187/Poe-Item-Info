<!DOCTYPE html>
<html lang="en" ng-app="itemAnalyzer">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Items - My ASP.NET Application</title>
		
		<link href="Content/bootstrap.css" rel="stylesheet" />
		<link href="Content/site.css" rel="stylesheet" />
		<script src="Scripts/angular.js"></script>
		<script src="Scripts/angular-route.js"></script>
		<script src="Scripts/angular-resource.js"></script>
	</head>
	<body>
		<div class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">
				<ul class="nav navbar-nav">
					<li><a ng-href="#/items">Home</a></li>
				</ul>
			</div>
		</div>
		<div class="container body-content">
			<div ng-view=""></div>
			
			<div>
				<hr />
				<footer>
					<p>&copy; Jan Daniel Andersen </p>
				</footer>
			</div>
		</div>

	</body>


	<script>
		var itemAnalyzer = angular.module("itemAnalyzer", ["ngRoute", "ngResource"])
			.factory("itemsFactory", [
				"$resource",
				function($resource) {
					return $resource('api/items', {}, {
						query: { method: 'GET', params: {}, isArray: true },
						getCategories: { method: 'GET', params: {}, isArray: true }
					});
				}
			])
			.config(function($routeProvider) {
				$routeProvider
					.when("/items",
					{
						controller: "itemsController",
						templateUrl: "Spa/partials/itemsList.html"
					})
					.when("/categories",
					{
						controller: "editCategoriesController",
						templateUrl: "Spa/partials/editCategories.html"
					})
					.otherwise({
						redirectTo: "/items"
					});
			})
			.controller("itemsController", function($scope, itemsFactory) {
				$scope.items = itemsFactory.query();
			})
			.controller("editCategoriesController", function($scope, itemsFactory) {
				$scope.items = itemsFactory.getCategories({ $top: 20, $select: "TypeLine, Icon" });
			});

	</script>
</html>